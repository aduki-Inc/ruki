<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ruki | Themed musics & comics</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/player.css">

</head>
<body>
  <div class="container" id="container">
    <div class="player-container" id="player-container">
      <section class="status top">
        <div class="current-song">
          <div class="cover">
            <img src="img/cover.jpg" alt="Cover Image">
          </div>
          <div class="fades">
            <span class="fade last"></span>
            <span class="fade first"></span>
            <span class="fade last"></span>
          </div>
          <div class="info">
            <h4 class="song-title">Bohemian Rhapsody (Remastered 2011)</h4>
            <span class="artist">Queen</span>
          </div>
        </div>
        <div class="right">Right</div>
      </section>
      <section class="lyrics">
        <div class="lyrics-container">
          <span class="dots current">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </span>
        </div>
      </section>
      <section class="controller footer">
        <div class="arrows">
          <div class="arrow next">
            <span class="up-next">
              <span class="text">#03 Up Next</span>
            </span>
            <div class="song">
              <h4 class="name">Don't stop believing</h4>
            </div>
          </div>
        </div>
        <div class="control-bar">
          <div class="top">
            <div class="time-container">
              <span class="time current-time">0:00</span>
              <span class="time separator">/</span>
              <span class="time all-time">0:00</span>
            </div>
            <div class="custom-seek">
              <span class="seek backward">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" color="currentColor" fill="none">
                  <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                      <stop offset="0%" style="stop-color:#DC143C"/>
                      <stop offset="100%" style="stop-color:#f09c4e"/>
                    </linearGradient>
                  </defs>
                  <path d="M12 5L10.8961 3.45459C10.4851 2.87911 10.2795 2.59137 10.4093 2.32411C10.5391 2.05684 10.8689 2.04153 11.5286 2.01092C11.6848 2.00367 11.842 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 8.72836 3.57111 5.82368 6 3.99927" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  <path d="M7.99219 11.004C8.52019 10.584 9.00019 9.89143 9.30019 10.02C9.60019 10.1486 9.50419 10.572 9.50419 11.232C9.50419 11.892 9.50419 14.6847 9.50419 16.008" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" />
                  <path d="M16.0022 12.6C16.0022 11.22 16.0682 10.848 15.8042 10.404C15.5402 9.96001 14.8802 9.99841 14.2202 9.99841C13.5602 9.99841 13.0802 9.96001 12.7622 10.32C12.3722 10.74 12.5402 11.52 12.4922 12.6C12.6002 14.04 12.3062 15.18 12.7562 15.66C13.0802 16.056 13.6553 15.996 14.3402 16.008C15.0201 15.9997 15.4322 16.032 15.7682 15.648C16.1402 15.312 15.9602 13.98 16.0022 12.6Z" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" />
                </svg>
              </span>
              <span class="seek forward">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" color="currentColor" fill="none">
                  <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                      <stop offset="0%" style="stop-color:#DC143C"/>
                      <stop offset="100%" style="stop-color:#f09c4e"/>
                    </linearGradient>
                  </defs>
                  <path d="M12 5L13.1039 3.45459C13.5149 2.87911 13.7205 2.59137 13.5907 2.32411C13.4609 2.05684 13.1311 2.04153 12.4714 2.01092C12.3152 2.00367 12.158 2 12 2C6.4772 2 2 6.47715 2 12C2 17.5228 6.4772 22 12 22C17.5229 22 22 17.5228 22 12C22 8.72836 20.4289 5.82368 18 3.99927" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  <path d="M7.99219 11.004C8.52019 10.584 9.00019 9.89143 9.30019 10.02C9.60019 10.1486 9.50419 10.572 9.50419 11.232C9.50419 11.892 9.50419 14.6847 9.50419 16.008" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" />
                  <path d="M16.0022 12.6C16.0022 11.22 16.0682 10.848 15.8042 10.404C15.5402 9.96001 14.8802 9.99841 14.2202 9.99841C13.5602 9.99841 13.0802 9.96001 12.7622 10.32C12.3722 10.74 12.5402 11.52 12.4922 12.6C12.6002 14.04 12.3062 15.18 12.7562 15.66C13.0802 16.056 13.6553 15.996 14.3402 16.008C15.0201 15.9997 15.4322 16.032 15.7682 15.648C16.1402 15.312 15.9602 13.98 16.0022 12.6Z" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" />
                </svg>
              </span>
            </div>
            <div class="repeate">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" color="currentColor" fill="none">
                <defs>
                  <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#DC143C"/>
                    <stop offset="100%" style="stop-color:#f09c4e"/>
                  </linearGradient>
                </defs>
                <path d="M16.3884 3L17.3913 3.97574C17.8393 4.41165 18.0633 4.62961 17.9844 4.81481C17.9056 5 17.5888 5 16.9552 5H9.19422C5.22096 5 2 8.13401 2 12C2 13.4872 2.47668 14.8662 3.2895 16" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M7.61156 21L6.60875 20.0243C6.16074 19.5883 5.93673 19.3704 6.01557 19.1852C6.09441 19 6.4112 19 7.04478 19H14.8058C18.779 19 22 15.866 22 12C22 10.5128 21.5233 9.13383 20.7105 8" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </div>
          </div>
          <div class="bottom">
            <div class="play-pause">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" color="currentColor">
                <defs>
                  <linearGradient id="gradient1" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#DC143C"/>
                    <stop offset="100%" style="stop-color:#f09c4e"/>
                  </linearGradient>
                </defs>
                <path d="M13.9405 6.337C15.5735 7.26468 16.8567 7.99369 17.7709 8.66148C18.6913 9.33386 19.3721 10.0366 19.6159 10.9632C19.7947 11.6426 19.7947 12.3574 19.6159 13.0368C19.3721 13.9634 18.6913 14.6661 17.7709 15.3385C16.8567 16.0063 15.5735 16.7353 13.9406 17.663L13.9406 17.663C12.3632 18.5591 11.033 19.3148 10.0232 19.7444C9.0053 20.1773 8.07729 20.3968 7.17536 20.1412C6.51252 19.9533 5.90941 19.5968 5.42356 19.1066C4.76419 18.4414 4.49951 17.5219 4.37429 16.4154C4.24998 15.3169 4.24999 13.879 4.25 12.0501V12.0501V11.9499V11.9499C4.24999 10.121 4.24998 8.68309 4.37429 7.58464C4.49951 6.4781 4.76419 5.55861 5.42356 4.89335C5.90941 4.40317 6.51252 4.04666 7.17536 3.85883C8.07729 3.60325 9.0053 3.82269 10.0232 4.25565C11.033 4.68516 12.3632 5.44084 13.9405 6.337Z" fill="url(#gradient1)">
              </svg>
            </div>
            <div class="progress-bar" role="progressbar" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100">
              <div class="progress"></div>
              <span class="point">
                <span class="dot"></span>
              </span>
            </div>
            <audio id="audio-element" style="display: none;"></audio>
          </div>
        </div>
      </section>
    </div>
  </div>
  <!-- <script src="js/audio.js"></script> -->
  <script type="module">
    import LyricsManager from './js/lyrics.js';
    import AudioPlayer from './js/audio.js';

    const audioMetaData = {
      title: 'Bohemian Rhapsody(Remastered 2011)',
      artist: 'Queen',
      album: 'Bohemian Rhapsody(The Original Soundtrack)',
      lyrics: './music/bhr.lrc',
      audio: './music/bhr.mp3',
      artwork: [
        {
          src: './img/cover.jpg',
          sizes: '96x96',
          type: 'image/jpg',
        },
        {
          src: './img/cover.jpg',
          sizes: '128x128',
          type: 'image/jpg',
        },
        {
          src: './img/cover.jpg',
          sizes: '192x192',
          type: 'image/jpg',
        },
        {
          src: './img/cover.jpg',
          sizes: '256x256',
          type: 'image/jpg',
        },
        {
          src: './img/cover.jpg',
          sizes: '384x384',
          type: 'image/jpg',
        },
        {
          src: './img/cover.jpg',
          sizes: '512x512',
          type: 'image/jpg',
        },
      ],
    };

    // Usage
    const controlBar = document.querySelector('.control-bar');
    const lyricsContainer = document.querySelector('.lyrics-container');
    const audioPlayer = new AudioPlayer(audioMetaData, controlBar);
    const lyricsManager = new LyricsManager(lyricsContainer, audioPlayer);

    // Load lyrics
    // lyricsManager.loadLyrics('/music/hhr.lrc', 'srt');
    // Or for custom format:
    lyricsManager.loadLyrics('./music/bhr.lrc', 'lrc');

    // Connect the LyricsManager to the AudioPlayer
    audioPlayer.setLyricsManager(lyricsManager);

    // Animate title
    function setupScrollingText() {
    const songTitles = document.querySelectorAll('.song-title');
    
    songTitles.forEach(title => {
      // Create a temporary element to measure the text width
      const tempSpan = document.createElement('span');
      tempSpan.style.visibility = 'hidden';
      tempSpan.style.position = 'absolute';
      tempSpan.style.whiteSpace = 'nowrap';
      tempSpan.innerHTML = title.innerHTML;
      document.body.appendChild(tempSpan);
      
      const textWidth = tempSpan.offsetWidth;
      document.body.removeChild(tempSpan);

      if (textWidth > title.offsetWidth) {
        const text = title.textContent;
        title.innerHTML = `<div class="scrolling-text-container"><span class="scrolling-text">${text}</span></div>`;
        
        const container = title.querySelector('.scrolling-text-container');
        const scrollingText = title.querySelector('.scrolling-text');
        
        // Adjust animation duration based on text length
        const duration = Math.max(20, textWidth / 50); // Minimum 20s, or longer for very long text
        scrollingText.style.animationDuration = `${duration}s`;
      }
    });
  }

  // Call the function when the page loads
  window.addEventListener('load', setupScrollingText);

  // Call this function when the song changes
  // For example: songChangeEvent.addEventListener('change', setupScrollingText);
  </script>
</body>
</html>